import{p as ue,ax as se,ay as ye,q as ie,E as de,az as ce,aA as xe,c as $,J as me,aB as ve,aC as j,L as a,M as E,aD as be,aE as he,G as V,s as ke,d as we,o as Ce,w as N,b as Pe,aF as Fe,aG as Se,O as L,aa as ae,aH as Ae,aI as Re,aJ as $e,aK as Ie,Q,aL as De,a as Me,a0 as Be,R as Ue,ad as Te,aM as qe,U as Ne,Y as le,W as ze,X as s,aw as Ee,ai as S,af as _,ag as R,ah as He,au as W,V as Ge,$ as Oe,aj as _e,Z as d,aN as Le,at as je,aq as Je,as as Ke,aO as Qe,aP as We,am as Xe,ac as Ye}from"./index-DKCvdjhR.js";import{c as Ze,a as X,b as et,d as tt,u as at,e as z,V as lt}from"./index.esm-U4-yYR5l.js";import{a as ot,V as oe,b as re}from"./route-block-A_OJPrSW.js";import{V as rt}from"./VDivider-CwfWU26r.js";import{m as nt,a as ne,V as ut,b as st}from"./VDataTable-Dgq11KTJ.js";import{V as it}from"./VToolbar-DMwmIQM3.js";import{V as dt}from"./VContainer-CkJ3D8mY.js";import"./VPagination-8_ScEYw9.js";import"./VList-rlTrpg6X.js";import"./VMenu-C4aYcRCu.js";const ct=ue({...se(),...ye(nt(),["inline"])},"VCheckbox"),mt=ie()({name:"VCheckbox",inheritAttrs:!1,props:ct(),emits:{"update:modelValue":e=>!0,"update:focused":e=>!0},setup(e,n){let{attrs:y,slots:p}=n;const i=de(e,"modelValue"),{isFocused:m,focus:x,blur:I}=ce(e),c=xe(),D=$(()=>e.id||`checkbox-${c}`);return me(()=>{const[M,U]=ve(y),B=j.filterProps(e),b=ne.filterProps(e);return a(j,E({class:["v-checkbox",e.class]},M,B,{modelValue:i.value,"onUpdate:modelValue":k=>i.value=k,id:D.value,focused:m.value,style:e.style}),{...p,default:k=>{let{id:f,messagesId:w,isDisabled:g,isReadonly:C,isValid:P}=k;return a(ne,E(b,{id:f.value,"aria-describedby":w.value,disabled:g.value,readonly:C.value},U,{error:P.value===!1,modelValue:i.value,"onUpdate:modelValue":T=>i.value=T,onFocus:x,onBlur:I}),p)}})}),{}}}),vt=ue({autoGrow:Boolean,autofocus:Boolean,counter:[Boolean,Number,String],counterValue:Function,prefix:String,placeholder:String,persistentPlaceholder:Boolean,persistentCounter:Boolean,noResize:Boolean,rows:{type:[Number,String],default:5,validator:e=>!isNaN(parseFloat(e))},maxRows:{type:[Number,String],validator:e=>!isNaN(parseFloat(e))},suffix:String,modelModifiers:Object,...se(),...be()},"VTextarea"),ft=ie()({name:"VTextarea",directives:{Intersect:he},inheritAttrs:!1,props:vt(),emits:{"click:control":e=>!0,"mousedown:control":e=>!0,"update:focused":e=>!0,"update:modelValue":e=>!0},setup(e,n){let{attrs:y,emit:p,slots:i}=n;const m=de(e,"modelValue"),{isFocused:x,focus:I,blur:c}=ce(e),D=$(()=>typeof e.counterValue=="function"?e.counterValue(m.value):(m.value||"").toString().length),M=$(()=>{if(y.maxlength)return y.maxlength;if(!(!e.counter||typeof e.counter!="number"&&typeof e.counter!="string"))return e.counter});function U(o,t){var u,h;!e.autofocus||!o||(h=(u=t[0].target)==null?void 0:u.focus)==null||h.call(u)}const B=V(),b=V(),k=ke(""),f=V(),w=$(()=>e.persistentPlaceholder||x.value||e.active);function g(){var o;f.value!==document.activeElement&&((o=f.value)==null||o.focus()),x.value||I()}function C(o){g(),p("click:control",o)}function P(o){p("mousedown:control",o)}function T(o){o.stopPropagation(),g(),Q(()=>{m.value="",De(e["onClick:clear"],o)})}function H(o){var u;const t=o.target;if(m.value=t.value,(u=e.modelModifiers)!=null&&u.trim){const h=[t.selectionStart,t.selectionEnd];Q(()=>{t.selectionStart=h[0],t.selectionEnd=h[1]})}}const v=V(),A=V(+e.rows),q=$(()=>["plain","underlined"].includes(e.variant));we(()=>{e.autoGrow||(A.value=+e.rows)});function l(){e.autoGrow&&Q(()=>{if(!v.value||!b.value)return;const o=getComputedStyle(v.value),t=getComputedStyle(b.value.$el),u=parseFloat(o.getPropertyValue("--v-field-padding-top"))+parseFloat(o.getPropertyValue("--v-input-padding-top"))+parseFloat(o.getPropertyValue("--v-field-padding-bottom")),h=v.value.scrollHeight,G=parseFloat(o.lineHeight),J=Math.max(parseFloat(e.rows)*G+u,parseFloat(t.getPropertyValue("--v-input-control-height"))),K=parseFloat(e.maxRows)*G+u||1/0,F=Be(h??0,J,K);A.value=Math.floor((F-u)/G),k.value=Me(F)})}Ce(l),N(m,l),N(()=>e.rows,l),N(()=>e.maxRows,l),N(()=>e.density,l);let r;return N(v,o=>{o?(r=new ResizeObserver(l),r.observe(v.value)):r==null||r.disconnect()}),Pe(()=>{r==null||r.disconnect()}),me(()=>{const o=!!(i.counter||e.counter||e.counterValue),t=!!(o||i.details),[u,h]=ve(y),{modelValue:G,...J}=j.filterProps(e),K=Fe(e);return a(j,E({ref:B,modelValue:m.value,"onUpdate:modelValue":F=>m.value=F,class:["v-textarea v-text-field",{"v-textarea--prefixed":e.prefix,"v-textarea--suffixed":e.suffix,"v-text-field--prefixed":e.prefix,"v-text-field--suffixed":e.suffix,"v-textarea--auto-grow":e.autoGrow,"v-textarea--no-resize":e.noResize||e.autoGrow,"v-input--plain-underlined":q.value},e.class],style:e.style},u,J,{centerAffix:A.value===1&&!q.value,focused:x.value}),{...i,default:F=>{let{id:O,isDisabled:Y,isDirty:Z,isReadonly:fe,isValid:pe}=F;return a(Se,E({ref:b,style:{"--v-textarea-control-height":k.value},onClick:C,onMousedown:P,"onClick:clear":T,"onClick:prependInner":e["onClick:prependInner"],"onClick:appendInner":e["onClick:appendInner"]},K,{id:O.value,active:w.value||Z.value,centerAffix:A.value===1&&!q.value,dirty:Z.value||e.dirty,disabled:Y.value,focused:x.value,error:pe.value===!1}),{...i,default:ge=>{let{props:{class:ee,...te}}=ge;return a(L,null,[e.prefix&&a("span",{class:"v-text-field__prefix"},[e.prefix]),ae(a("textarea",E({ref:f,class:ee,value:m.value,onInput:H,autofocus:e.autofocus,readonly:fe.value,disabled:Y.value,placeholder:e.placeholder,rows:e.rows,name:e.name,onFocus:g,onBlur:c},te,h),null),[[Ae("intersect"),{handler:U},null,{once:!0}]]),e.autoGrow&&ae(a("textarea",{class:[ee,"v-textarea__sizer"],id:`${te.id}-sizer`,"onUpdate:modelValue":Ve=>m.value=Ve,ref:v,readonly:!0,"aria-hidden":"true"},null),[[Re,m.value]]),e.suffix&&a("span",{class:"v-text-field__suffix"},[e.suffix])])}})},details:t?F=>{var O;return a(L,null,[(O=i.details)==null?void 0:O.call(i,F),o&&a(L,null,[a("span",null,null),a($e,{active:e.persistentCounter||x.value,value:D.value,max:M.value,disabled:e.disabled},i.counter)])])}:void 0})}),Ie({},B,b,f)}}),pt={class:"text-center"},gt={__name:"products",setup(e){const{t:n}=Ue(),{apiAuth:y}=Xe(),p=Te(),i=qe([]),m=V(""),x=$(()=>[{title:"ID",key:"_id",sortable:!0},{title:n("product.image"),key:"image",sortable:!1},{title:n("product.name"),key:"name",sortable:!0},{title:n("product.description"),key:"description",sortable:!0},{title:n("product.price"),key:"price",sortable:!0},{title:n("product.category"),key:"category",sortable:!0},{title:n("product.sell"),key:"sell",sortable:!0},{title:n("product.createdAt"),key:"createdAt",sortable:!0},{title:n("product.updatedAt"),key:"updatedAt",sortable:!0},{title:n("adminProduct.edit"),key:"edit",sortable:!1}]),I=async()=>{var l,r;try{const{data:o}=await y.get("/product/all");i.push(...o.result)}catch(o){console.log(o),p({text:n("api."+(((r=(l=o==null?void 0:o.response)==null?void 0:l.data)==null?void 0:r.message)||"unknownError")),snackbarProps:{color:"red"}})}};I();const c=V({open:!1,id:""}),D=l=>{console.log("openDialog"),l&&(c.value.id=l._id,f.value.value=l.name,w.value.value=l.price,g.value.value=l.description,C.value.value=l.category,P.value.value=l.sell),c.value.open=!0},M=()=>{k(),c.value.id="",c.value.open=!1,H.value},U=Ze({name:X().required(n("api.productNameRequired")),price:et().required(n("api.productPriceRequired")).min(0,n("api.productPriceTooSmall")),description:X().required(n("api.productDescriptionRequired")),category:X().required(n("api.productCategoryRequired")).oneOf(["food","drink","music","phone"],n("api.productCategoryInvalid")),sell:tt().required(n("api.productSellRequired"))}),{handleSubmit:B,isSubmitting:b,resetForm:k}=at({validationSchema:U,initialValues:{name:"",price:0,description:"",category:"",sell:!1}}),f=z("name"),w=z("price"),g=z("description"),C=z("category"),P=z("sell"),T=$(()=>[{text:n("productCategory.food"),value:"food"},{text:n("productCategory.drink"),value:"drink"},{text:n("productCategory.music"),value:"music"},{text:n("productCategory.phone"),value:"phone"}]),H=V(null),v=V([]),A=V([]),q=B(async l=>{var r,o,t;if(!((r=v.value[0])!=null&&r.error)){if(c.value.id.length===0&&v.value.length===0){p({text:n("api.productImageRequired"),snackbarProps:{color:"red"}});return}try{const u=new FormData;u.append("name",l.name),u.append("price",l.price),u.append("description",l.description),u.append("category",l.category),u.append("sell",l.sell),v.value.length>0&&u.append("image",v.value[0].file),c.value.id.length>0?await y.patch("/product/"+c.value.id,u):await y.post("/product",u),i.splice(0,i.length),I(),p({text:n(c.value.id.length>0?"adminProduct.editSuccess":"adminProduct.newSuccess"),snackbarProps:{color:"green"}}),M()}catch(u){console.log(u),p({text:n("api."+(((t=(o=u==null?void 0:u.response)==null?void 0:o.data)==null?void 0:t.message)||"unknownError")),snackbarProps:{color:"red"}})}}});return(l,r)=>{const o=Ne("VueFileAgent");return le(),ze(L,null,[a(dt,null,{default:s(()=>[a(ot,null,{default:s(()=>[a(oe,{cols:"12"},{default:s(()=>[Ee("h1",pt,S(l.$t("nav.adminProducts")),1)]),_:1}),a(rt),a(oe,{cols:"12"},{default:s(()=>[a(ut,{items:i,search:m.value,headers:x.value},{top:s(()=>[a(it,null,{default:s(()=>[a(_,{onClick:r[0]||(r[0]=t=>D(null))},{default:s(()=>[R(S(l.$t("adminProduct.new")),1)]),_:1}),a(He),a(W,{"prepend-inner-icon":"mdi-magnify",variant:"underlined"})]),_:1})]),"item.image":s(({value:t})=>[a(Ge,{src:t,height:"50"},null,8,["src"])]),"item.sell":s(({value:t})=>[t?(le(),Oe(Ye,{key:0,icon:"mdi-check"})):_e("",!0)]),"item.createdAt":s(({value:t})=>[R(S(new Date(t).toLocaleString()),1)]),"item.updatedAt":s(({value:t})=>[R(S(new Date(t).toLocaleString()),1)]),"item.category":s(({value:t})=>[R(S(l.$t("productCategory."+t)),1)]),"item.edit":s(({item:t})=>[a(_,{icon:"mdi-pencil",variant:"text",onClick:u=>D(t)},null,8,["onClick"])]),_:2},1032,["items","search","headers"])]),_:1})]),_:1})]),_:1}),a(We,{modelValue:c.value.open,"onUpdate:modelValue":r[8]||(r[8]=t=>c.value.open=t),persistent:""},{default:s(()=>[a(lt,{disabled:d(b),onSubmit:Le(d(q),["prevent"])},{default:s(()=>[a(je,null,{default:s(()=>[a(Je,null,{default:s(()=>[R(S(l.$t(c.value.id?"adminProduct.edit":"adminProduct.new")),1)]),_:1}),a(Ke,null,{default:s(()=>[a(W,{modelValue:d(f).value.value,"onUpdate:modelValue":r[1]||(r[1]=t=>d(f).value.value=t),label:l.$t("product.name"),"error-messages":d(f).errorMessage.value},null,8,["modelValue","label","error-messages"]),a(W,{modelValue:d(w).value.value,"onUpdate:modelValue":r[2]||(r[2]=t=>d(w).value.value=t),label:l.$t("product.price"),"error-messages":d(w).errorMessage.value},null,8,["modelValue","label","error-messages"]),a(st,{modelValue:d(C).value.value,"onUpdate:modelValue":r[3]||(r[3]=t=>d(C).value.value=t),"error-messages":d(C).errorMessage.value,items:T.value,label:l.$t("product.category"),"item-title":"text","item-value":"value"},null,8,["modelValue","error-messages","items","label"]),a(mt,{modelValue:d(P).value.value,"onUpdate:modelValue":r[4]||(r[4]=t=>d(P).value.value=t),label:l.$t("product.onSell"),"error-messages":d(P).errorMessage.value},null,8,["modelValue","label","error-messages"]),a(ft,{modelValue:d(g).value.value,"onUpdate:modelValue":r[5]||(r[5]=t=>d(g).value.value=t),label:l.$t("product.description"),"error-messages":d(g).errorMessage.value},null,8,["modelValue","label","error-messages"]),a(o,{ref_key:"fileAgent",ref:H,modelValue:v.value,"onUpdate:modelValue":r[6]||(r[6]=t=>v.value=t),"raw-model-value":A.value,"onUpdate:rawModelValue":r[7]||(r[7]=t=>A.value=t),accept:"image/jpeg,image/png",deletable:"","max-size":"1MB","help-text":l.$t("fileAgent.helpText"),"error-text":{type:l.$t("fileAgent.errorType"),size:l.$t("fileAgent.errorSize")}},null,8,["modelValue","raw-model-value","help-text","error-text"])]),_:1}),a(Qe,null,{default:s(()=>[a(_,{onClick:M},{default:s(()=>[R(S(l.$t("adminProduct.cancel")),1)]),_:1}),a(_,{type:"submit",loading:d(b)},{default:s(()=>[R(S(l.$t("adminProduct.submit")),1)]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},8,["disabled","onSubmit"])]),_:1},8,["modelValue"])],64)}}};typeof re=="function"&&re(gt);export{gt as default};
